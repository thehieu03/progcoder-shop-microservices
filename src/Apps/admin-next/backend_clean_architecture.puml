@startuml Service_Clean_Architecture

title Service X - Clean Architecture Package Diagram
top to bottom direction

' Style configuration
skinparam packageStyle rectangle
skinparam componentStyle uml2
skinparam linetype ortho

' Define Packages
package "SharedKernel" <<Common>> {
    [Types]
    [Abstractions]
    [Common Utilities]
}

package "X.Domain" <<Core Domain>> {
    [Entities]
    [Value Objects]
    [Domain Events]
    [Domain Services]
}

package "X.Application" <<Use Cases>> {
    [Use Cases / Interactors]
    [DTOs]
    [Input/Output Ports]
    [Validators]
}

package "X.Infrastructure" <<Implementation>> {
    [Database / EF Core]
    [Repositories Impl]
    [Message Broker Adapters]
    [External API Clients]
}

package "X.API" <<Entry Point>> {
    [Controllers]
    [Endpoints]
    [Middlewares]
}

' Define Dependencies

' 1. SharedKernel is the base
X.Domain ..> SharedKernel
X.Application ..> SharedKernel

' 2. Domain is independent (Center)
' No outgoing arrows from Domain to App/Infra/API

' 3. Application depends on Domain
X.Application ..> X.Domain : <<uses>>

' 4. Infrastructure depends on Application (Implementing interfaces/ports defined in App)
X.Infrastructure ..> X.Application : <<implements ports>>
X.Infrastructure ..> X.Domain : <<maps to>>
X.Infrastructure ..> SharedKernel

' 5. API depends on Application (Calls Use Cases)
X.API ..> X.Application : <<executes>>
X.API ..> SharedKernel

@enduml
